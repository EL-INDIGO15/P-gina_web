<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Activar key tras abrir enlaces</title>
  <style>
    :root { --bg: #0f1724; --card: #0b1220; --accent: #6ee7b7; --muted:#a6b0c3; }
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background: linear-gradient(180deg,#071226 0%, #091827 100%);
      color: white;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .card{
      width:100%;
      max-width:720px;
      background: rgba(255,255,255,0.03);
      border-radius:14px;
      padding:20px;
      box-shadow: 0 6px 24px rgba(1,6,12,0.6);
      backdrop-filter: blur(6px);
    }
    h1{ margin:0 0 8px 0; font-size:20px; }
    p { margin:0 0 16px 0; color:var(--muted); }
    .links { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:16px; }
    a.btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 14px;
      border-radius:10px;
      text-decoration:none;
      color: #032019;
      background: var(--accent);
      font-weight:600;
      box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    }
    .btn.secondary{
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(110,231,183,0.12);
      box-shadow:none;
    }
    .status{ margin-bottom:12px; color:var(--muted); font-size:14px; }
    .reveal{
      margin-top:12px;
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .keybox{
      width:100%;
      background: rgba(255,255,255,0.04);
      border-radius:10px;
      padding:12px;
      font-family:monospace;
      font-size:16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .key-text{ word-break:break-all; color:#dffcf0; }
    .small { font-size:13px; color:var(--muted); }
    .hidden{ display:none; }
    footer { margin-top:14px; font-size:13px; color:var(--muted); }
    @media (max-width:420px){
      .links{ flex-direction:column; }
    }
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>Accede a los enlaces para activar la key</h1>
    <p class="small">Abre ambos enlaces. Tras abrirlos, se mostrará el botón para obtener la key y podrás copiarla.</p>

    <div class="links">
      <a id="link1" class="btn" href="https://www.youtube.com/@Indigo-d6x" target="_blank" rel="noopener noreferrer">
        Suscríbete al canal
      </a>

      <a id="link2" class="btn secondary" href="https://youtu.be/jGX2IK4GUbI?si=jp4Ph2BkaL-5HAKH" target="_blank" rel="noopener noreferrer">
        Ve el vídeo completo
      </a>
    </div>

    <div class="status" id="statusText">
      Enlaces abiertos: <span id="count">0</span>/2
    </div>

    <div class="reveal">
      <button id="showKeyBtn" class="btn secondary" disabled>
        Obtener Key
      </button>
      <a id="directKeyLink" class="btn hidden" href="#key" >Ir a la página de la key</a>
    </div>

    <div id="keySection" class="hidden" aria-hidden="true" style="margin-top:16px;">
      <div class="small">Aquí está la key:</div>
      <div class="keybox" role="region" aria-label="Caja de key">
        <div class="key-text" id="theKey">Key_188637828-INDIGOHUB</div>
        <div style="display:flex; gap:8px;">
          <button id="copyBtn" class="btn" title="Copiar key">Copiar</button>
          <button id="doneBtn" class="btn secondary">Hecho</button>
        </div>
      </div>
      <div class="small" style="margin-top:10px;">La key también puede copiarse manualmente seleccionando el texto.</div>
    </div>

    <footer>
      <strong>Aviso:</strong> Esta página solo detecta clics, no confirma que hayas visto o suscrito.
    </footer>
  </div>

  <script>
    const KEY_VALUE = "Key_188637828-INDIGOHUB";
    const link1 = document.getElementById('link1');
    const link2 = document.getElementById('link2');
    const statusText = document.getElementById('count');
    const showKeyBtn = document.getElementById('showKeyBtn');
    const directKeyLink = document.getElementById('directKeyLink');
    const keySection = document.getElementById('keySection');
    const theKey = document.getElementById('theKey');
    const copyBtn = document.getElementById('copyBtn');
    const doneBtn = document.getElementById('doneBtn');

    const storageKey = "visited_links_indigo";
    function loadVisited(){
      try {
        const raw = localStorage.getItem(storageKey);
        return raw ? JSON.parse(raw) : { l1:false, l2:false };
      } catch(e){ return { l1:false, l2:false }; }
    }
    function saveVisited(obj){ localStorage.setItem(storageKey, JSON.stringify(obj)); }

    let visited = loadVisited();
    updateUI();

    link1.addEventListener('click', () => {
      visited.l1 = true;
      saveVisited(visited);
      updateUI();
    });

    link2.addEventListener('click', () => {
      visited.l2 = true;
      saveVisited(visited);
      updateUI();
    });

    function updateUI(){
      const count = (visited.l1?1:0) + (visited.l2?1:0);
      statusText.textContent = count;
      if(count >= 2){
        showKeyBtn.disabled = false;
        directKeyLink.classList.remove('hidden');
      } else {
        showKeyBtn.disabled = true;
        directKeyLink.classList.add('hidden');
      }
      if(localStorage.getItem('key_shown_indigo') === "1"){
        revealKeySection();
      }
    }

    showKeyBtn.addEventListener('click', () => {
      localStorage.setItem('key_shown_indigo', "1");
      revealKeySection();
      location.hash = "#key";
    });

    directKeyLink.addEventListener('click', (e) => {
      e.preventDefault();
      localStorage.setItem('key_shown_indigo', "1");
      revealKeySection();
      location.hash = "#key";
    });

    function revealKeySection(){
      keySection.classList.remove('hidden');
      keySection.setAttribute('aria-hidden', 'false');
      theKey.textContent = KEY_VALUE;
    }

    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(KEY_VALUE);
        copyBtn.textContent = "Copiado ✓";
        setTimeout(()=> copyBtn.textContent = "Copiar", 2000);
      } catch (err) {
        const ta = document.createElement('textarea');
        ta.value = KEY_VALUE;
        document.body.appendChild(ta);
        ta.select();
        try { document.execCommand('copy'); copyBtn.textContent = "Copiado ✓"; } catch(e){ alert("Copia manual"); }
        document.body.removeChild(ta);
        setTimeout(()=> copyBtn.textContent = "Copiar", 2000);
      }
    });

    doneBtn.addEventListener('click', () => {
      localStorage.removeItem(storageKey);
      localStorage.removeItem('key_shown_indigo');
      visited = { l1:false, l2:false };
      updateUI();
      keySection.classList.add('hidden');
      keySection.setAttribute('aria-hidden', 'true');
      location.hash = "";
    });

    window.addEventListener('storage', (ev) => {
      if(ev.key === storageKey || ev.key === 'key_shown_indigo'){
        visited = loadVisited();
        updateUI();
      }
    });
  </script>
</body>
</html>
